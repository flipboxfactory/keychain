{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% block actionButton %}
    <div class="btngroup submit right">
        <input type="submit" class="btn submit" value="{{ 'Save'|t('app') }}">

        <div class="btn submit menubtn"></div>
        <div class="menu">
            <ul>
                <li><a class="formsubmit" data-redirect="{{ continueEditingUrl }}">
                        {{ "Save and continue editing"|t('app') }}
                        {{ forms.optionShortcutLabel('S') }}
                    </a></li>
            </ul>
        </div>
    </div>
{% endblock %}


{% block content %}

    <div class="grid first" data-max-cols="3">
        <div class="item" data-position="left" data-colspan="2">

            <input type="hidden" name="action"
                   value="{{ baseActionPath }}/{% if keypair.id %}update{% else %}create{% endif %}">
            {{ redirectInput(baseCpPath) }}

            {% if keypair.id %}<input type="hidden" name="identifier" value="{{ keypair.id }}">{% endif %}

            {{ forms.textField({
                label: "Description"|t('keychain'),
                instructions: "Describe the what this key pair is for."|t('keychain'),
                name: "description",
                id: 'description',
                value: keypair.description,
                errors: keypair.getErrors('keypair'),
            }) }}

            {{ forms.lightswitchField({
                label: "Enable"|t('keychain'),
                id: 'enabled',
                name: 'enabled',
                on: keypair.enabled,
                errors: keypair.getErrors('enabled')
            }) }}

            {{ forms.textareaField({
                label: "Key"|t('keychain'),
                instructions: "Key"|t('keychain'),
                class: "code",
                id: 'key',
                name: 'key',
                value:  keypair.getDecryptedKey(),
                errors: keypair.getErrors('key'),
                required: true,
                rows: 10
            }) }}

            {{ forms.textareaField({
                label: "Certificate"|t('keychain'),
                instructions: "Certificate"|t('keychain'),
                class: "code",
                id:   'certificate',
                name: 'certificate',
                value:  keypair.getDecryptedCertificate(),
                errors: keypair.getErrors('certificate'),
                required: true,
                rows: 10
            }) }}

            {{ forms.lightswitchField({
                label: "Is Encrypted"|t('keychain'),
                instructions: "Encrypt the key and certificate when it's stored in the db. This uses the Craft security key."|t('keychain'),
                id: 'isEncrypted',
                name: 'isEncrypted',
                on: keypair.isEncrypted,
                errors: keypair.getErrors('isEncrypted')
            }) }}

        </div>
        <div class="item" data-position="right" data-colspan="1"></div>
    </div>

{% endblock %}
